<?xml version="1.0" ?>

<Problem>

  <Mesh>
    <InternalMesh
      name="mesh1"
      elementTypes="{ C3D8 }"
      xCoords="{ 0, 365.76 }"
      yCoords="{ 0, 670.56 }"
      zCoords="{ 0, 51.816 }"
      nx="{ 30 }"
      ny="{ 55 }"
      nz="{ 21 }"
      cellBlockNames="{ block}"/>
  </Mesh>

  <Included>
    <File name="./SPE10_base2_deadoil.xml" />
  </Included>

  <Solvers>

    <CompositionalMultiphaseFVM
      name="twoPhaseFlow"
      logLevel="1"
      discretization="fluidTPFA"
      targetRegions="{ reservoir }"      
      temperature="300"
      targetRelativePressureChangeInTimeStep="1"
      targetPhaseVolFractionChangeInTimeStep="1"
      useMass="1"
      initialDt="1e3"
      maxCompFractionChange="0.1">
      <NonlinearSolverParameters
        newtonTol="1.0e-6"
        newtonMaxIter="40"
        maxTimeStepCuts="10"
        lineSearchAction="None"/>
      <LinearSolverParameters
        solverType="gmres"
	    preconditionerType="iluk" 
        krylovTol="1.0e-10"/>
    </CompositionalMultiphaseFVM>

  </Solvers>

  <!-- Add this Events section to trigger output -->
  <Events
    maxTime="8e7">

   <PeriodicEvent
      name="outputs"
      timeFrequency="4e7"
      targetExactTimestep="1"
      target="/Outputs/vtkOutput"/>
    
    <PeriodicEvent
      name="solverApplications"
      maxEventDt="1e6"  
      target="/Solvers/twoPhaseFlow"/>
  </Events>

  <Outputs>
    <VTK
      name="vtkOutput"
      plotFileRoot="SPE10_fim_lvl0a"
      plotLevel="2"
      format="binary"/>

  </Outputs>

</Problem>
